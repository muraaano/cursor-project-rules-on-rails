---
description: 
globs: db/migrate/*.rb
alwaysApply: false
---
# DBマイグレーションの実装規約

## 全般

- マイグレーションファイルは`db/migrate`に配置する
- マイグレーションファイルの命名規則は`YYYYMMDDHHMMSS_create_table_name.rb`とする
- マイグレーションファイルは、操作するテーブルごとにファイルを分ける（1ファイルで1つのテーブルを作成する）
- 過去のマイグレーションファイルは修正しないこと
- データ構造の変更が必要な場合は、新しいマイグレーションファイルを作成する
- マイグレーションファイルのバージョンは、現在使用しているRailsのバージョンに合わせること（例: Rails 7.2を使用している場合は`ActiveRecord::Migration[7.2]`と指定）

## カラム定義

### カラム名

- Date型のカラムは末尾に`_date`をつけること（例：`planned_date`）
- DateTime型のカラムは末尾に`_at`をつけること（例：`planned_at`）

### 外部キー
- `references`を使用する場合は、明示的なインデックスの追加は不要
  - `references`が自動的にインデックスを作成するため
- 外部キーを持つテーブルは、参照先のテーブルが先に作成されていることを確認すること
  - マイグレーションファイルの番号で制御すること

### コメント
- カラムには論理名（日本語）をコメントとして追加する。コメントは設計ドキュメントの論理名を使用する

```ruby
# 例
t.string :name, null: false, comment: "名前"
```

